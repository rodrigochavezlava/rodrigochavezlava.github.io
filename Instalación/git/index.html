<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Rodrigo Chavez" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>GITHUB - SIEM Proyecto</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../stylesheets/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "GITHUB";
        var mkdocs_page_input_path = "Instalaci\u00f3n/git.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/python.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> SIEM Proyecto
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Introducción</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Introducci%C3%B3n/Introducci%C3%B3n/">Introducción</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Introducci%C3%B3n/Funcionamiento-del-SIEM/">Funcionamiento del SIEM</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Instalación</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">GITHUB</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#documentacion-del-proyecto">Documentación del proyecto</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#script-del-proyecto">Script del proyecto</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Documentación</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">Docker</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentaci%C3%B3n/Docker/docker/">Instalación Docker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentaci%C3%B3n/Docker/docker-compose/">Instalación Docker Compose</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentaci%C3%B3n/Docker/RedEncriptadaconDocker/">Red Encriptada con Docker</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Archivos-de-configuración</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentaci%C3%B3n/Archivos-de-configuraci%C3%B3n/docker-compose/">Docker-Compose.yml</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentaci%C3%B3n/Archivos-de-configuraci%C3%B3n/filebeat/">Filebeat.yml</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentaci%C3%B3n/Archivos-de-configuraci%C3%B3n/logstash/">Logstash.yml</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Documentaci%C3%B3n/Archivos-de-configuraci%C3%B3n/suricata/">Suricata.yml</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">SIEM Proyecto</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Instalación &raquo;</li>
      <li>GITHUB</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="github">GITHUB<a class="headerlink" href="#github" title="Permanent link">&para;</a></h1>
<h3 id="documentacion-del-proyecto">Documentación del proyecto<a class="headerlink" href="#documentacion-del-proyecto" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code>Link git proyecto: https://github.com/rodrigochavezlava/ProyectoSIEM
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Clonar git del script: $ git clone https://github.com/rodrigochavezlava/ProyectoSIEM/blob/main/SIEMProyecto.sh
</code></pre></div>

<h2 id="script-del-proyecto">Script del proyecto<a class="headerlink" href="#script-del-proyecto" title="Permanent link">&para;</a></h2>
<p>Recordemos que la idea de este script es ejecutarlo en nuestra máquina para tener un SIEM completamente funcional con tan solo un comando. Todo esto se consigue mediante la unión de diferentes servicios a través de contenedores.</p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Solicitar al usuario que ingrese un valor</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Ingresa el nombre de la tarjeta de red que desees analizar:&quot;</span>
<span class="nb">read</span><span class="w"> </span>tarjetaRed

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Escoge la contraseña de tu encriptación de red | min: 32 caracteres&quot;</span>
<span class="nb">read</span><span class="w"> </span>claveEncriptacionRed

<span class="c1">#Calcula el numero de caracteres de la contraseña con el #</span>
<span class="nv">longitud</span><span class="o">=</span><span class="si">${#</span><span class="nv">claveEncriptacionRed</span><span class="si">}</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;La longitud de la contraseña es: </span><span class="nv">$longitud</span><span class="s2"> caracteres.&quot;</span>

<span class="c1">#Compara longitud en caso de ser menor de 32 se para</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$longitud</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;La contraseña tiene 32 caracteres.&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;La contraseña no tiene 32 caracteres, SALIENDO.&quot;</span>
<span class="w">    </span><span class="nb">exit</span>
<span class="k">fi</span>


<span class="c1">#Inicio</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span>-y
<span class="c1">#Paquetes para uso de repositorios seguros HTTPS</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>apt-transport-https<span class="w"> </span>ca-certificates<span class="w"> </span>curl<span class="w"> </span>gnupg<span class="w"> </span>lsb-release
<span class="c1">#Claves GPG y volcarlas en /usr/share/keyrings</span>
curl<span class="w"> </span>-fsSL<span class="w"> </span>https://download.docker.com/linux/ubuntu/gpg<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span>-o<span class="w"> </span>/usr/share/keyrings/docker-archive-keyring.gpg
<span class="c1">#Añadir la direccion de los repositorios al sistema</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu </span><span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span><span class="s2"> stable&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/docker.list<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="c1">#Actualizar el repositorio</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span>-y
<span class="c1">#Instalar Docker</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>docker-ce<span class="w"> </span>docker-ce-cli<span class="w"> </span>containerd.io
<span class="c1">#Descargar Docker Compose</span>
sudo<span class="w"> </span>curl<span class="w"> </span>-L<span class="w"> </span><span class="s2">&quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-</span><span class="k">$(</span>uname<span class="w"> </span>-s<span class="k">)</span><span class="s2">-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-o<span class="w"> </span>/usr/local/bin/docker-compose
<span class="c1">#Dar permisos para ejecutar al Docker Compose</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/docker-compose
<span class="c1">#Creacion docker compose - Redirije el contenido del EOF al archivo indicado con &gt; archivoDestino</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt; docker-compose.yml</span>
<span class="s">version: &#39;3.7&#39;</span>
<span class="s">services:</span>
<span class="s">  elasticsearch:</span>
<span class="s">    image: docker.elastic.co/elasticsearch/elasticsearch:7.15.2</span>
<span class="s">    container_name: elasticsearch</span>
<span class="s">    environment:</span>
<span class="s">      - node.name=elasticsearch</span>
<span class="s">      - cluster.name=es-docker-cluster</span>
<span class="s">      - bootstrap.memory_lock=true</span>
<span class="s">      - &quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot;</span>
<span class="s">      - &quot;discovery.type=single-node&quot;</span>
<span class="s">      - &quot;xpack.security.enabled=false&quot;</span>
<span class="s">    ulimits:</span>
<span class="s">      memlock:</span>
<span class="s">        soft: -1</span>
<span class="s">        hard: -1</span>
<span class="s">    volumes:</span>
<span class="s">      - esdata:/usr/share/elasticsearch/data</span>
<span class="s">    ports:</span>
<span class="s">      - 9200:9200</span>

<span class="s">  kibana:</span>
<span class="s">    image: docker.elastic.co/kibana/kibana:7.15.2</span>
<span class="s">    container_name: kibana</span>
<span class="s">    ports:</span>
<span class="s">      - 5601:5601</span>
<span class="s">    environment:</span>
<span class="s">      ELASTICSEARCH_URL: &lt;http://elasticsearch:9200/&gt;  # URL de Elasticsearch</span>
<span class="s">    volumes:</span>
<span class="s">      - ./kibana.yml:/usr/share/kibana/config/kibana.yml</span>
<span class="s">    depends_on:</span>
<span class="s">      - elasticsearch</span>

<span class="s">  filebeat:</span>
<span class="s">    image: docker.elastic.co/beats/filebeat:7.15.2</span>
<span class="s">    container_name: filebeat</span>
<span class="s">    user: root</span>
<span class="s">    volumes:</span>
<span class="s">      - ./filebeat.yml:/usr/share/filebeat/filebeat.yml:ro</span>
<span class="s">      - /var/log:/var/log:ro</span>
<span class="s">    depends_on:</span>
<span class="s">      - elasticsearch</span>

<span class="s">  logstash:</span>
<span class="s">    image: docker.elastic.co/logstash/logstash:7.15.2</span>
<span class="s">    container_name: logstash</span>
<span class="s">    volumes:</span>
<span class="s">      - ./logstash.conf:/usr/share/logstash/pipeline/logstash.conf:ro</span>
<span class="s">    ports:</span>
<span class="s">      - 5044:5044</span>
<span class="s">    depends_on:</span>
<span class="s">      - elasticsearch</span>

<span class="s">  suricata:</span>
<span class="s">    image: jasonish/suricata:latest</span>
<span class="s">    user: root</span>
<span class="s">    privileged: true</span>
<span class="s">    volumes:</span>
<span class="s">      - /var/log/suricata:/var/log/suricata</span>
<span class="s">      - ./suricata.yaml:/etc/suricata/suricata.yaml:ro</span>
<span class="s">      - /var/lib/suricata/rules:/var/lib/suricata/rules</span>
<span class="s">      - /etc/suricata/classification.config:/etc/suricata/classification.config</span>
<span class="s">    network_mode: &quot;host&quot;</span>
<span class="s">    command: -c /etc/suricata/suricata.yaml -i $tarjetaRed</span>

<span class="s">volumes:</span>
<span class="s">  esdata:</span>
<span class="s">    driver: local</span>
<span class="s">networks:</span>
<span class="s">  default:</span>
<span class="s">    external:</span>
<span class="s">      name: encriptadisimo</span>
<span class="s">EOF</span>
<span class="c1">#Creacion filebeat - Redirije el contenido del EOF al archivo indicado con &gt; archivoDestino</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt; filebeat.yml</span>
<span class="s">filebeat.inputs:</span>
<span class="s">- type: log</span>
<span class="s">  enabled: true</span>
<span class="s">  paths:</span>
<span class="s">    - /var/log/*.log</span>
<span class="s">    - /var/log/syslog</span>
<span class="s">    - /var/log/nginx/*.log</span>
<span class="s">    - /var/log/apache2/*.log</span>
<span class="s">    - /var/log/mysql/error.log</span>
<span class="s">    - /var/log/postgresql/*.log</span>
<span class="s">    - /var/log/suricata/eve.json</span>
<span class="s">    - /var/log/packetbeat/*</span>

<span class="s">filebeat.modules:</span>
<span class="s">- module: system</span>
<span class="s">  syslog:</span>
<span class="s">    enabled: false</span>
<span class="s">  auth:</span>
<span class="s">    enabled: true</span>
<span class="s">    var.paths: [&quot;/var/log/auth.log&quot;]</span>

<span class="s">output.logstash:</span>
<span class="s">  hosts: [&quot;logstash:5044&quot;]</span>

<span class="s">setup.kibana:</span>
<span class="s">  host: &quot;kibana:5601&quot;</span>

<span class="s">fields:</span>
<span class="s">  event.dataset: keyword</span>
<span class="s">EOF</span>
<span class="c1">#Creacion logstash - Redirije el contenido del EOF al archivo indicado con &gt; archivoDestino</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt; logstash.conf</span>
<span class="s">input {</span>
<span class="s">  beats {</span>
<span class="s">    port =&gt; 5044</span>
<span class="s">  }</span>
<span class="s">}</span>

<span class="s">filter {</span>
<span class="s">  if [fileset][module] == &quot;system&quot; {</span>
<span class="s">    if [fileset][name] == &quot;auth&quot; {</span>
<span class="s">      grok {</span>
<span class="s">        match =&gt; {</span>
<span class="s">          &quot;message&quot; =&gt; [</span>
<span class="s">            &quot;%{SYSLOGTIMESTAMP:[system][auth][timestamp]} %{SYSLOGHOST:[system][auth][hostname]} sshd(?:\[%{POSINT:[system][auth][pid]}\])?: %{DATA:[system][auth][ssh][event]} %{DATA:[system][auth][ssh][method]} %{DATA:[system][auth][ssh][username]} %{DATA:[system][auth][ssh][ip]}(?: %{GREEDYDATA:[system][auth][ssh][data]})?&quot;,</span>
<span class="s">            &quot;%{SYSLOGTIMESTAMP:[system][auth][timestamp]} %{SYSLOGHOST:[system][auth][hostname]} sudo(?:\[%{POSINT:[system][auth][pid]}\])?: %{DATA:[system][auth][user]} %{DATA:[system][auth][sudo][tty]}=%{DATA:[system][auth][sudo][user]}(?:\(%{DATA:[system][auth][sudo][runas]}\))?: %{GREEDYDATA:[system][auth][sudo][command]}&quot;</span>
<span class="s">          ]</span>
<span class="s">        }</span>
<span class="s">        pattern_definitions =&gt; {</span>
<span class="s">          &quot;GREEDYDATA&quot; =&gt; &quot;.*&quot;</span>
<span class="s">        }</span>
<span class="s">        remove_field =&gt; &quot;message&quot;</span>
<span class="s">      }</span>
<span class="s">      mutate {</span>
<span class="s">        rename =&gt; { &quot;@timestamp&quot; =&gt; &quot;read_timestamp&quot; }</span>
<span class="s">      }</span>
<span class="s">      date {</span>
<span class="s">        match =&gt; [ &quot;[system][auth][timestamp]&quot;, &quot;MMM  d HH:mm:ss&quot;, &quot;MMM dd HH:mm:ss&quot; ]</span>
<span class="s">      }</span>
<span class="s">      geoip {</span>
<span class="s">        source =&gt; &quot;[system][auth][ssh][ip]&quot;</span>
<span class="s">        target =&gt; &quot;[system][auth][ssh][geoip]&quot;</span>
<span class="s">      }</span>
<span class="s">      if [system][auth][sudo][command] {</span>
<span class="s">        grok {</span>
<span class="s">          match =&gt; { &quot;[system][auth][sudo][command]&quot; =&gt; &quot;^ %{USER:[system][auth][sudo][run_as_user]} : TTY=%{DATA:[system][auth][sudo][tty]} ; PWD=%{DATA:[system][auth][sudo][pwd]} ; USER=%{USER:[system][auth][sudo][user]} ; COMMAND=%{GREEDYDATA:[system][auth][sudo][command]}&quot; }</span>
<span class="s">        }</span>
<span class="s">      }</span>
<span class="s">    }</span>
<span class="s">  }</span>
<span class="s">}</span>

<span class="s">output {</span>
<span class="s">  elasticsearch {</span>
<span class="s">    hosts =&gt; [&quot;elasticsearch:9200&quot;]</span>
<span class="s">    manage_template =&gt; false</span>
<span class="s">    index =&gt; &quot;filebeat&quot;</span>
<span class="s">  }</span>
<span class="s">}</span>
<span class="s">EOF</span>
<span class="c1">#Creacion suricata - Redirije el contenido del EOF al archivo indicado con &gt; archivoDestino</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt; suricata.yaml</span>
<span class="s">%YAML 1.1</span>
<span class="s">---</span>
<span class="s"># Configuración de Suricata</span>
<span class="s">default-log-dir: /var/log/suricata/</span>

<span class="s"># Definición de las reglas</span>
<span class="s">rule-files:</span>
<span class="s">  - /var/lib/suricata/rules/*.rules</span>

<span class="s"># Configuración de los registros</span>
<span class="s">outputs:</span>
<span class="s">  - fast:</span>
<span class="s">      enabled: yes</span>
<span class="s">      filename: fast.log</span>
<span class="s">      append: yes</span>
<span class="s">  - eve-log:</span>
<span class="s">      enabled: yes</span>
<span class="s">      filetype: regular</span>
<span class="s">      filename: eve.json</span>
<span class="s">      append: yes</span>
<span class="s">  - syslog:</span>
<span class="s">      enabled: yes</span>
<span class="s"># Configuración de la detección de anomalías</span>
<span class="s">anomaly:</span>
<span class="s">  detection-ports:</span>
<span class="s">    - 21  # FTP</span>
<span class="s">    - 22  # SSH</span>
<span class="s">    - 23  # Telnet</span>
<span class="s">    - 25  # SMTP</span>
<span class="s">    - 80  # HTTP</span>

<span class="s"># Configuración de los protocolos de capa de aplicación</span>
<span class="s"># Configuración de los protocolos de capa de aplicación</span>
<span class="s">app-layer:</span>
<span class="s">  protocols:</span>
<span class="s">    dcerpc:</span>
<span class="s">      enabled: yes</span>
<span class="s">    smb:</span>
<span class="s">      enabled: yes</span>
<span class="s">    ftp:</span>
<span class="s">      enabled: yes</span>
<span class="s">    ssh:</span>
<span class="s">      enabled: yes</span>
<span class="s">    smtp:</span>
<span class="s">      enabled: yes</span>
<span class="s">    dns:</span>
<span class="s">      enabled: yes</span>
<span class="s">    modbus:</span>
<span class="s">      enabled: no</span>
<span class="s">    http:</span>
<span class="s">      enabled: yes</span>
<span class="s">    tls:</span>
<span class="s">      enabled: yes</span>
<span class="s">    enip:</span>
<span class="s">      enabled: yes</span>
<span class="s">    dnp3:</span>
<span class="s">      enabled: yes</span>
<span class="s">    nfs:</span>
<span class="s">      enabled: yes</span>
<span class="s">    ntp:</span>
<span class="s">      enabled: yes</span>
<span class="s">    tftp:</span>
<span class="s">      enabled: yes</span>
<span class="s">    ikev2:</span>
<span class="s">      enabled: no</span>
<span class="s">    krb5:</span>
<span class="s">      enabled: yes</span>
<span class="s">    dhcp:</span>
<span class="s">      enabled: yes</span>
<span class="s">    snmp:</span>
<span class="s">      enabled: yes</span>
<span class="s">    sip:</span>
<span class="s">      enabled: yes</span>
<span class="s">    rfb:</span>
<span class="s">      enabled: yes</span>
<span class="s">    mqtt:</span>
<span class="s">      enabled: yes</span>
<span class="s">    rdp:</span>
<span class="s">      enabled: yes</span>
<span class="s">    http2:</span>
<span class="s">      enabled: yes</span>
<span class="s">    imap:</span>
<span class="s">      enabled: yes</span>

<span class="s"># Configuración de las interfaces</span>
<span class="s">af-packet:</span>
<span class="s">  - interface: $tarjetaRed</span>
<span class="s">    cluster-id: 99</span>
<span class="s">    cluster-type: cluster_flow</span>
<span class="s">    defrag: yes</span>

<span class="s"># Configuración de la preprocesamiento</span>
<span class="s">prelude:</span>
<span class="s">  enabled: yes</span>
<span class="s">  log-dir: /var/log/suricata/</span>

<span class="s"># Configuración de la extracción de archivos</span>
<span class="s">file-extraction:</span>
<span class="s">  enabled: yes</span>
<span class="s">  # Directorio donde se almacenan los archivos extraídos</span>
<span class="s">  directory: /var/log/suricata/files</span>
<span class="s">  # Establecer en &#39;yes&#39; para habilitar el cálculo automático del hash MD5 del archivo</span>
<span class="s">  # md5: yes</span>

<span class="s"># Configuración de los registros HTTP</span>
<span class="s">http-log:</span>
<span class="s">  enabled: yes</span>
<span class="s">  filetype: regular</span>
<span class="s">  filename: http.log</span>
<span class="s">  append: yes</span>
<span class="s">  extended: yes</span>

<span class="s"># Configuración de los registros TLS</span>
<span class="s">tls-log:</span>
<span class="s">  enabled: yes</span>
<span class="s">  filetype: regular</span>
<span class="s">  filename: tls.log</span>
<span class="s">  append: yes</span>
<span class="s">  extended: yes</span>
<span class="s">EOF</span>
<span class="c1">#Creacion kibana - Redirije el contenido del EOF al archivo indicado con &gt; archivoDestino</span>
cat<span class="w"> </span><span class="s">&lt;&lt;EOF &gt; kibana.yml</span>
<span class="s">elasticsearch.hosts: [&quot;http://elasticsearch:9200/&quot;]</span>

<span class="s">xpack.encryptedSavedObjects.encryptionKey: &quot;andreqwerqwerqwerqwerqwerqwerqwerqwerqwer&quot;</span>

<span class="s">server.name: kibana</span>
<span class="s">server.host: &quot;0&quot;</span>
<span class="s">EOF</span>
<span class="c1">#Permisos</span>
sudo<span class="w"> </span>chown<span class="w"> </span>root:root<span class="w"> </span>filebeat.yml
sudo<span class="w"> </span>chmod<span class="w"> </span>a+r<span class="w"> </span>filebeat.yml
sudo<span class="w"> </span>chmod<span class="w"> </span>go-w<span class="w"> </span>filebeat.yml
<span class="c1">#Git clone de suricata</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/OISF/suricata.git
<span class="c1"># Reglas de Suricata y permisos de suricata</span>
sudo<span class="w"> </span>mkdir<span class="w"> </span>/var/lib/suricata
sudo<span class="w"> </span>mkdir<span class="w"> </span>/var/lib/suricata/rules
sudo<span class="w"> </span>mkdir<span class="w"> </span>/etc/suricata
sudo<span class="w"> </span>mv<span class="w"> </span>suricata/etc/reference.config<span class="w"> </span>/etc/suricata/
sudo<span class="w"> </span>mv<span class="w"> </span>suricata/etc/classification.config<span class="w"> </span>/etc/suricata/
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">777</span><span class="w"> </span>-R<span class="w"> </span>/etc/suricata/
sudo<span class="w"> </span>mv<span class="w"> </span>suricata/rules/*<span class="w"> </span>/var/lib/suricata/rules/
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">777</span><span class="w"> </span>-R<span class="w"> </span>/var/lib/suricata/
<span class="c1"># Red Encriptada de Docker</span>
sudo<span class="w"> </span>docker<span class="w"> </span>swarm<span class="w"> </span>init
sudo<span class="w"> </span>docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>--opt<span class="w"> </span>encrypted<span class="w"> </span>--attachable<span class="w"> </span>--driver<span class="w"> </span>overlay<span class="w"> </span>encriptadisimo
<span class="c1">#Levantar el servicio</span>
sudo<span class="w"> </span>docker-compose<span class="w"> </span>up<span class="w"> </span>-d
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SIEM montado correctamente&quot;</span><span class="w"> </span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Para entrar en kibana --&gt; http://localhost:5601&quot;</span>
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../Introducci%C3%B3n/Funcionamiento-del-SIEM/" class="btn btn-neutral float-left" title="Funcionamiento del SIEM"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../Documentaci%C3%B3n/Docker/docker/" class="btn btn-neutral float-right" title="Instalación Docker">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../Introducci%C3%B3n/Funcionamiento-del-SIEM/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../Documentaci%C3%B3n/Docker/docker/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
